<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Animating RM4SCC Barcodes - Ben Coveney&#x27;s Blog</title><meta name="description" content="Rendering RM4SCC Barcodes with SVG and SMIL animations"/><meta name="author" content="Ben Coveney"/><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"/><link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png"/><link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"/><link rel="manifest" href="/site.webmanifest"/><link rel="mask-icon" href="/safari-pinned-tab.svg" color="#10141a"/><meta name="msapplication-TileColor" content="#10141a"/><meta name="theme-color" content="#10141a"/><link rel="canonical" href="https://bencoveney.com/posts/rm4scc.html"/><link href="https://cdn.materialdesignicons.com/2.2.43/css/materialdesignicons.min.css" media="all" rel="stylesheet" type="text/css"/><link rel="alternate" type="application/atom+xml" title="Ben Coveney&#x27;s Blog" href="/feed.xml"/><meta property="og:title" content="Animating RM4SCC Barcodes - Ben Coveney&#x27;s Blog"/><meta property="og:type" content="article"/><meta property="og:image" content="/posts/rm4scc-ben.png"/><meta property="og:url" content="https://bencoveney.com/posts/rm4scc.html"/><meta name="twitter:card" content="summary_large_image"/><meta property="og:description" content="Rendering RM4SCC Barcodes with SVG and SMIL animations"/><meta property="og:site_name" content="Ben Coveney&#x27;s Blog"/><style>.published-0-0-39{margin-bottom:1rem;font-style:italic;text-align:center;width:100%;display:inline-block;color:var(--foreground-color-medium);}.title-0-0-40{padding:var(--vertical-padding) var(--horizontal-padding);margin:0 auto var(--vertical-padding) auto;max-width:800px;}:root{--font-family-sans-serif:-apple-system, BlinkMacSystemFont, avenir next, avenir, segoe ui, helvetica neue, helvetica, Cantarell, Ubuntu, roboto, noto, arial, sans-serif;--font-family-serif:Iowan Old Style, Apple Garamond, Baskerville, Times New Roman, Droid Serif, Times, Source Serif Pro, serif, Apple Color Emoji, Segoe UI Emoji, Segoe UI Symbol, serif;--font-family-mono:Menlo, Consolas, Monaco, Liberation Mono, Lucida Console, monospace;--font-family-body:var(--font-family-sans-serif);--font-family-heading:var(--font-family-serif);--font-family-code:var(--font-family-mono);--color-black:rgb(0, 0, 0);--color-white:rgb(255, 255, 255);--color-blue-50:rgb(1, 7, 19);--color-blue-100:rgb(5, 20, 40);--color-blue-200:rgb(15, 43, 77);--color-blue-300:rgb(27, 67, 115);--color-blue-400:rgb(42, 93, 155);--color-blue-500:rgb(61, 120, 194);--color-blue-600:rgb(91, 149, 223);--color-blue-700:rgb(132, 178, 238);--color-blue-800:rgb(175, 205, 245);--color-blue-900:rgb(216, 231, 250);--color-blue-950:rgb(236, 243, 253);--color-violet-50:rgb(6, 4, 24);--color-violet-100:rgb(18, 13, 48);--color-violet-200:rgb(40, 31, 91);--color-violet-300:rgb(62, 50, 133);--color-violet-400:rgb(86, 72, 176);--color-violet-500:rgb(112, 100, 210);--color-violet-600:rgb(139, 133, 229);--color-violet-700:rgb(168, 166, 239);--color-violet-800:rgb(197, 197, 245);--color-violet-900:rgb(226, 227, 250);--color-violet-950:rgb(241, 241, 253);--color-sky-50:rgb(1, 9, 13);--color-sky-100:rgb(3, 23, 30);--color-sky-200:rgb(12, 47, 60);--color-sky-300:rgb(23, 73, 91);--color-sky-400:rgb(35, 101, 124);--color-sky-500:rgb(48, 130, 158);--color-sky-600:rgb(66, 160, 193);--color-sky-700:rgb(94, 189, 224);--color-sky-800:rgb(144, 214, 242);--color-sky-900:rgb(202, 236, 250);--color-sky-950:rgb(229, 245, 252);--color-night-50:rgb(5, 7, 11);--color-night-100:rgb(16, 20, 26);--color-night-200:rgb(36, 44, 54);--color-night-300:rgb(56, 67, 82);--color-night-400:rgb(79, 93, 111);--color-night-500:rgb(104, 121, 141);--color-night-600:rgb(132, 149, 170);--color-night-700:rgb(162, 177, 195);--color-night-800:rgb(193, 204, 217);--color-night-900:rgb(224, 230, 237);--color-night-950:rgb(240, 242, 246);--background-color-medium:var(--color-night-100);--background-color-light:var(--color-night-200);--bg-color:var(--color-night-50);--bg-color-alternate:var(--color-night-100);--foreground-color-dark:var(--color-night-500);--foreground-color-medium:var(--color-night-700);--fg-color:var(--color-night-950);--foreground-color-link:var(--fg-color);--highlight-color:var(--color-sky-500);--highlight-color-2:var(--color-violet-500);--horizontal-padding:3rem;--vertical-padding:1.5rem;}@media (color-gamut: p3) {:root{--color-blue-50:color(display-p3 0.0094 0.0272 0.0723);--color-blue-100:color(display-p3 0.0306 0.0770 0.1528);--color-blue-200:color(display-p3 0.0877 0.1664 0.2930);--color-blue-300:color(display-p3 0.1478 0.2586 0.4370);--color-blue-400:color(display-p3 0.2151 0.3583 0.5887);--color-blue-500:color(display-p3 0.2961 0.4654 0.7375);--color-blue-600:color(display-p3 0.4084 0.5790 0.8515);--color-blue-700:color(display-p3 0.5547 0.6933 0.9118);--color-blue-800:color(display-p3 0.7087 0.8016 0.9462);--color-blue-900:color(display-p3 0.8572 0.9030 0.9736);--color-blue-950:color(display-p3 0.9290 0.9518 0.9867);--color-violet-50:color(display-p3 0.0228 0.0158 0.0903);--color-violet-100:color(display-p3 0.0678 0.0503 0.1820);--color-violet-200:color(display-p3 0.1509 0.1219 0.3415);--color-violet-300:color(display-p3 0.2368 0.1972 0.5033);--color-violet-400:color(display-p3 0.3297 0.2838 0.6655);--color-violet-500:color(display-p3 0.4310 0.3930 0.7952);--color-violet-600:color(display-p3 0.5413 0.5208 0.8722);--color-violet-700:color(display-p3 0.6573 0.6505 0.9155);--color-violet-800:color(display-p3 0.7740 0.7736 0.9464);--color-violet-900:color(display-p3 0.8881 0.8893 0.9735);--color-violet-950:color(display-p3 0.9441 0.9450 0.9867);--color-night-50:color(display-p3 0.0214 0.0282 0.0410);--color-night-100:color(display-p3 0.0645 0.0790 0.1016);--color-night-200:color(display-p3 0.1456 0.1697 0.2072);--color-night-300:color(display-p3 0.2297 0.2632 0.3153);--color-night-400:color(display-p3 0.3213 0.3638 0.4298);--color-night-500:color(display-p3 0.4213 0.4706 0.5471);--color-night-600:color(display-p3 0.5299 0.5807 0.6592);--color-night-700:color(display-p3 0.6461 0.6905 0.7590);--color-night-800:color(display-p3 0.7654 0.7974 0.8465);--color-night-900:color(display-p3 0.8836 0.9000 0.9253);--color-night-950:color(display-p3 0.9418 0.9501 0.9628);}}@media screen and (max-width: 768px) {:root{--horizontal-padding:1.5rem;}}*{margin:0;padding:0;list-style-type:none;text-decoration:none;line-height:150%;}html, body{width:100%;min-height:100%;font-family:var(--font-family-body);color:var(--fg-color);background-color:var(--bg-color);}a:link, a:visited, a:active, a:hover{color:var(--foreground-color-link);}.wrapper-0-0-1{width:100%;min-height:100%;box-sizing:border-box;display:flex;flex-direction:column;}.container-0-0-2{position:sticky;top:0;z-index:10;background-color:var(--background-color-medium);margin:0 auto var(--vertical-padding) auto;box-sizing:border-box;width:100%;max-width:800px;display:flex;justify-content:space-between;align-items:stretch;border-bottom:3px solid var(--color-blue-400);}.link-0-0-3{display:flex;align-items:center;padding:10px var(--horizontal-padding);}.link-0-0-3:hover{background-color:var(--background-color-light);}.name-0-0-4{font-family:var(--font-family-heading);font-weight:100;position:relative;line-height:120%;font-size:1.618em;display:flex;align-items:center;}.home-0-0-5{text-align:right;display:flex;align-items:stretch;}.icon-0-0-6{color:var(--foreground-color-dark);position:relative;top:2px;margin-left:0.5rem;}.heading1-0-0-29{font-family:var(--font-family-heading);font-weight:100;position:relative;line-height:120%;display:block;text-align:center;}@media screen and (max-width: 768px) {.heading1-0-0-29{font-size:2.618em;}}@media screen and (min-width: 769px) {.heading1-0-0-29{font-size:3em;}}.heading2-0-0-30{font-family:var(--font-family-heading);font-weight:100;position:relative;line-height:120%;display:block;text-align:center;}@media screen and (max-width: 768px) {.heading2-0-0-30{font-size:1.618em;}}@media screen and (min-width: 769px) {.heading2-0-0-30{font-size:2.618em;}}.heading3-0-0-31{font-family:var(--font-family-heading);font-weight:100;position:relative;line-height:120%;margin-top:var(--vertical-padding);}@media screen and (max-width: 768px) {.heading3-0-0-31{font-size:1.618em;}}@media screen and (min-width: 769px) {.heading3-0-0-31{font-size:1.618em;}}.heading4-0-0-32{font-family:var(--font-family-heading);font-weight:100;position:relative;line-height:120%;margin-top:var(--vertical-padding);}@media screen and (max-width: 768px) {.heading4-0-0-32{font-size:1.618em;}}@media screen and (min-width: 769px) {.heading4-0-0-32{font-size:1.3em;}}.heading5-0-0-33{font-family:var(--font-family-heading);font-weight:100;position:relative;line-height:120%;margin-top:var(--vertical-padding);}@media screen and (max-width: 768px) {.heading5-0-0-33{font-size:1.618em;}}@media screen and (min-width: 769px) {.heading5-0-0-33{font-size:1.3em;}}.heading6-0-0-34{font-family:var(--font-family-heading);font-weight:100;position:relative;line-height:120%;margin-top:var(--vertical-padding);}@media screen and (max-width: 768px) {.heading6-0-0-34{font-size:1.618em;}}@media screen and (min-width: 769px) {.heading6-0-0-34{font-size:1.3em;}}.content-0-0-38{background-color:var(--background-color-medium);flex:0 0 auto;margin:0 auto var(--vertical-padding) auto;box-sizing:border-box;width:100%;max-width:800px;padding:var(--vertical-padding) var(--horizontal-padding);}.markdown-0-0-28{--foreground-color-link:var(--color-blue-700);}.markdown-0-0-28 p{margin-top:var(--vertical-padding);}.markdown-0-0-28 blockquote{margin-top:var(--vertical-padding);background-color:var(--bg-color-alternate);color:var(--fg-color);padding:0.01em var(--horizontal-padding) var(--vertical-padding) var(--horizontal-padding);font-size:1.1em;margin-left:calc(var(--horizontal-padding) * -1);margin-right:calc(var(--horizontal-padding) * -1);--double-margin:calc(var(--horizontal-padding) * 2);width:calc(100% + var(--double-margin));box-sizing:border-box;}.markdown-0-0-28 .image-wrapper{margin-left:calc(var(--horizontal-padding) * -1);margin-right:calc(var(--horizontal-padding) * -1);--double-margin:calc(var(--horizontal-padding) * 2);width:calc(100% + var(--double-margin));box-sizing:border-box;margin-top:var(--vertical-padding);background-color:var(--color-black);display:flex;flex-direction:column;justify-content:center;align-items:center;padding:var(--vertical-padding) var(--horizontal-padding);}.markdown-0-0-28 pre code.hljs{margin-top:var(--vertical-padding);display:block;overflow-x:auto;padding:var(--vertical-padding) var(--horizontal-padding);margin-left:calc(var(--horizontal-padding) * -1);margin-right:calc(var(--horizontal-padding) * -1);--double-margin:calc(var(--horizontal-padding) * 2);width:calc(100% + var(--double-margin));box-sizing:border-box;}.markdown-0-0-28 code.hljs{font-family:var(--font-family-code);padding:3px 5px;}.markdown-0-0-28 a:link, .markdown-0-0-28 a:hover, .markdown-0-0-28 a:visited, .markdown-0-0-28 a:active{text-decoration:underline;}.markdown-0-0-28 ul{margin-top:var(--vertical-padding);margin-left:25px;}.markdown-0-0-28 ol{margin-top:var(--vertical-padding);margin-left:25px;}.markdown-0-0-28 h1{margin-top:var(--vertical-padding);font-family:var(--font-family-heading);font-weight:100;position:relative;line-height:120%;display:block;text-align:center;}.markdown-0-0-28 h2{margin-top:calc(var(--vertical-padding) * 2);font-family:var(--font-family-heading);font-weight:100;position:relative;line-height:120%;display:block;text-align:center;}.markdown-0-0-28 h3{font-family:var(--font-family-heading);font-weight:100;position:relative;line-height:120%;margin-top:var(--vertical-padding);}.markdown-0-0-28 h4{font-family:var(--font-family-heading);font-weight:100;position:relative;line-height:120%;margin-top:var(--vertical-padding);}.markdown-0-0-28 h5{font-family:var(--font-family-heading);font-weight:100;position:relative;line-height:120%;margin-top:var(--vertical-padding);}.markdown-0-0-28 h6{font-family:var(--font-family-heading);font-weight:100;position:relative;line-height:120%;margin-top:var(--vertical-padding);}.markdown-0-0-28 hr{max-width:50%;display:block;text-align:center;margin:2em auto;}.markdown-0-0-28 iframe{margin-top:var(--vertical-padding);aspect-ratio:16 / 9;height:100%;margin-left:calc(var(--horizontal-padding) * -1);margin-right:calc(var(--horizontal-padding) * -1);--double-margin:calc(var(--horizontal-padding) * 2);width:calc(100% + var(--double-margin));box-sizing:border-box;}.markdown-0-0-28 video{margin-left:calc(var(--horizontal-padding) * -1);margin-right:calc(var(--horizontal-padding) * -1);--double-margin:calc(var(--horizontal-padding) * 2);width:calc(100% + var(--double-margin));box-sizing:border-box;margin-top:var(--vertical-padding);}.markdown-0-0-28 .hljs{color:#d5c4a1;background:#282828;}.markdown-0-0-28 .hljs ::selection, .markdown-0-0-28 .hljs::selection{background-color:#504945;color:#d5c4a1;}.markdown-0-0-28 .hljs-comment{color:#665c54;}.markdown-0-0-28 .hljs-tag{color:#bdae93;}.markdown-0-0-28 .hljs-operator, .markdown-0-0-28 .hljs-punctuation, .markdown-0-0-28 .hljs-subst{color:#d5c4a1;}.markdown-0-0-28 .hljs-operator{opacity:0.7;}.markdown-0-0-28 .hljs-bullet, .markdown-0-0-28 .hljs-deletion, .markdown-0-0-28 .hljs-name, .markdown-0-0-28 .hljs-selector-tag, .markdown-0-0-28 .hljs-template-variable, .markdown-0-0-28 .hljs-variable{color:#fb4934;}.markdown-0-0-28 .hljs-attr, .markdown-0-0-28 .hljs-link, .markdown-0-0-28 .hljs-literal, .markdown-0-0-28 .hljs-number, .markdown-0-0-28 .hljs-symbol, .markdown-0-0-28 .hljs-variable.constant_{color:#fe8019;}.markdown-0-0-28 .hljs-class .hljs-title, .markdown-0-0-28 .hljs-title, .markdown-0-0-28 .hljs-title.class_{color:#fabd2f;}.markdown-0-0-28 .hljs-strong{font-weight:700;color:#fabd2f;}.markdown-0-0-28 .hljs-addition, .markdown-0-0-28 .hljs-code, .markdown-0-0-28 .hljs-string, .markdown-0-0-28 .hljs-title.class_.inherited__{color:#b8bb26;}.markdown-0-0-28 .hljs-built_in, .markdown-0-0-28 .hljs-doctag, .markdown-0-0-28 .hljs-keyword.hljs-atrule, .markdown-0-0-28 .hljs-quote, .markdown-0-0-28 .hljs-regexp{color:#8ec07c;}.markdown-0-0-28 .hljs-attribute, .markdown-0-0-28 .hljs-function .hljs-title, .markdown-0-0-28 .hljs-section, .markdown-0-0-28 .hljs-title.function_, .markdown-0-0-28 .ruby .hljs-property{color:#83a598;}.markdown-0-0-28 .diff .hljs-meta, .markdown-0-0-28 .hljs-keyword, .markdown-0-0-28 .hljs-template-tag, .markdown-0-0-28 .hljs-type{color:#d3869b;}.markdown-0-0-28 .hljs-emphasis{color:#d3869b;font-style:italic;}.markdown-0-0-28 .hljs-meta, .markdown-0-0-28 .hljs-meta .hljs-keyword, .markdown-0-0-28 .hljs-meta .hljs-string{color:#d65d0e;}.markdown-0-0-28 .hljs-meta .hljs-keyword, .markdown-0-0-28 .hljs-meta-keyword{font-weight:700;}.markdown-0-0-28 > :first-child{margin-top:0;}@media screen and (max-width: 768px) {.markdown-0-0-28 h6{font-size:1.618em;}}@media screen and (min-width: 769px) {.markdown-0-0-28 h6{font-size:1.3em;}}@media screen and (max-width: 768px) {.markdown-0-0-28 h5{font-size:1.618em;}}@media screen and (min-width: 769px) {.markdown-0-0-28 h5{font-size:1.3em;}}@media screen and (max-width: 768px) {.markdown-0-0-28 h4{font-size:1.618em;}}@media screen and (min-width: 769px) {.markdown-0-0-28 h4{font-size:1.3em;}}@media screen and (max-width: 768px) {.markdown-0-0-28 h3{font-size:1.618em;}}@media screen and (min-width: 769px) {.markdown-0-0-28 h3{font-size:1.618em;}}@media screen and (max-width: 768px) {.markdown-0-0-28 h2{font-size:1.618em;}}@media screen and (min-width: 769px) {.markdown-0-0-28 h2{font-size:2.618em;}}@media screen and (max-width: 768px) {.markdown-0-0-28 h1{font-size:2.618em;}}@media screen and (min-width: 769px) {.markdown-0-0-28 h1{font-size:3em;}}.markdown-0-0-28 ol li{margin-top:0.75rem;list-style-type:decimal;}.markdown-0-0-28 ol ol{margin-top:0;}.markdown-0-0-28 ol li::marker{color:var(--foreground-color-medium);}.markdown-0-0-28 ul li{margin-top:0.75rem;list-style-type:disc;}.markdown-0-0-28 ul ul{margin-top:0;}.markdown-0-0-28 ul li::marker{color:var(--foreground-color-dark);}.markdown-0-0-28 .image-wrapper img{display:block;max-width:100%;max-height:50vh;}.markdown-0-0-28 .image-wrapper .image-title{margin-top:0.5rem;color:var(--fg-color);text-align:center;}.linkSet-0-0-35{margin-top:var(--vertical-padding);}.link-0-0-36{margin-right:5px;--foreground-color-link:var(--color-blue-700);}.icon-0-0-37{color:var(--fg-color);}.technologies-0-0-11{clear:both;margin-top:var(--vertical-padding);}.compact-0-0-12{margin-top:0;}.technology-0-0-13{float:left;border-radius:5px;font-size:0.707em;margin:5px;display:flex;flex-direction:row;flex-wrap:nowrap;align-items:center;}.tagRed-0-0-14{background-color:var(--highlight-color);}.tagGreen-0-0-15{background-color:var(--highlight-color-2);}.icon-0-0-16{color:var(--fg-color);margin:0 5px;}.tag-0-0-17{background-color:var(--bg-color-alternate);padding:5px;border-radius:5px;}</style></head><body><div class="wrapper-0-0-1"><div class="container-0-0-2"><header class="name-0-0-4"><a href="/" class="link-0-0-3">Ben Coveney</a></header><nav class="home-0-0-5"><a href="/" class="link-0-0-3"><div>Home</div><i class="mdi mdi-home mdi-18px icon-0-0-6"></i></a></nav></div><div class="title-0-0-40"><h1 class="heading1-0-0-29">Animating RM4SCC Barcodes</h1><span class="published-0-0-39">Published <!-- -->Jun 15, 2024</span></div><div class="content-0-0-38"><div class="markdown-0-0-28"><p>Royal Mail 4-State Customer Code barcodes (RM4SCC for short, or CBCs - Customer Bar Codes) are used by Royal Mail for post sorting in the UK, but have also been adopted and adapted by postal services in other countries. They enable post to be quickly read by a machins, which ultimately brings down the cost for businesses sending large numbers of letters.</p>
<h2>Building a barcode</h2>
<p>The &quot;4-State&quot; part of the name refers to each individual bar, which can be:</p>
<ul>
<li>Short</li>
<li>Extending Upwards</li>
<li>Extending Downwards</li>
<li>Long</li>
</ul>
<p>Collections of 4 bars are mapped to characters covering the ranges A-Z and 0-9, which gives coverage of all UK postcodes. The mapping does not include every possible combination of 4 bars; each grouping has 2 upwards and downward extensions.</p>
<p><figure class="image-wrapper"><a href="/posts/rm4scc-character-map.png" target="_blank"><img src="/posts/rm4scc-character-map.png" alt="RM4SCC Character Map" title="How bars are composed into characters"/></a><figcaption class="image-title">How bars are composed into characters</figcaption></figure></p>
<p>If they were to include every possible combination of bars, they might have been able to get away with fewer bars-per-character. At 3 bars, you&#x27;d have 4Â³ (or 64) possibilities, which comfortably covers the 36 characters required, however this would presumably come at the cost of reducing machine-readablility.</p>
<p>I&#x27;ve been looking at RM4SCC barcodes quite a bit over the last few days, to the point that I&#x27;m starting to see little pictures inside the characters. Call me crazy, but:</p>
<ul>
<li><code>k</code> Looks like a bull.</li>
<li><code>3</code> and <code>x</code> look like chairs.</li>
<li><code>2</code> and <code>w</code> look like toilets.</li>
</ul>
<p><em>Anyway...</em> A &quot;complete&quot; barcode is composed of 5 parts:</p>
<ul>
<li>A special start character.</li>
<li>A UK postcode, which can be between 5 and 7 alphanumeric characters.</li>
<li>A delivery point suffix (or DPS), which is another 2 alphanumeric characters.</li>
<li>A checksum, which can be used to validate the content of the barcode.</li>
<li>A special stop character.</li>
</ul>
<p><figure class="image-wrapper"><a href="/posts/rm4scc-barcode-parts.png" target="_blank"><img src="/posts/rm4scc-barcode-parts.png" alt="RM4SCC Complete Barcode" title="The component parts of a complete RM4SCC barcode"/></a><figcaption class="image-title">The component parts of a complete RM4SCC barcode</figcaption></figure></p>
<p>Delivery point suffixes are not typically seen by recipients of UK post. They point to smaller areas within a postcode and help sort mail more granularly so that it is in &quot;walk&quot; order, ready for when the postman does his route. Not every postcode has DPS values, so <code>9u</code> to <code>9z</code> can be used as defaults.</p>
<p>I won&#x27;t detail the complete <a href="https://en.wikipedia.org/wiki/RM4SCC#Checksum" target="_blank">checksum calculation</a> here, but it involves:</p>
<ul>
<li>Calcuating weighted values for each bar extending upwards and downwards.</li>
<li>Summing those weights, and taking the modulo 6 of those results.</li>
<li>Taking that result, and mapping it back into the character set.</li>
</ul>
<p>In addition to defining the data encoding, Royal Mail specifies some constrains for how the barcode should be printed. This includes the physical layout of the bars, but also the spacing around the barcode, and even the difference in reflectance between the bars and the background they are printed on.</p>
<p><figure class="image-wrapper"><a href="/posts/rm4scc-printing-constraints.png" target="_blank"><img src="/posts/rm4scc-printing-constraints.png" alt="RM4SCC Printing Constraints" title="Royal Mail&#x27;s CDC printing requirements"/></a><figcaption class="image-title">Royal Mail&#x27;s CDC printing requirements</figcaption></figure></p>
<h2>Generating SVG Barcodes</h2>
<p>Having learnt a bit about these barcodes, I decided it would be interesting to try building some myself. My <a href="https://bencoveney.com/RM4SCC/" target="_blank">RM4SCC Barcode Generator</a> is a single React page which takes input and creates an SVG barcode. The input can be a real postcode or arbitrary data, and there are controls for the sizing and rendering of the output.</p>
<p><figure class="image-wrapper"><a href="/posts/rm4scc-barcode-generator.png" target="_blank"><img src="/posts/rm4scc-barcode-generator.png" alt="RM4SCC Barcode Generator" title="The barcode generator in all of its glory"/></a><figcaption class="image-title">The barcode generator in all of its glory</figcaption></figure></p>
<p>One thing I didn&#x27;t really appreciate about these barcodes until playing around with them in the generator is that the sizing constraints do still allow for a reasonable amount of control over the aesthetics. Its possible to have valid barcodes that are long and skinny, or short and thick.</p>
<p><figure class="image-wrapper"><a href="/posts/rm4scc-size-comparisons.png" target="_blank"><img src="/posts/rm4scc-size-comparisons.png" alt="RM4SCC Size Comparisons" title="The same barcode, in 2 different (valid) size configurations"/></a><figcaption class="image-title">The same barcode, in 2 different (valid) size configurations</figcaption></figure></p>
<p>Being quite small, simple, and composed from basic geometric shapes, these barcodes can make for quite good logos.</p>
<p><figure class="image-wrapper"><a href="/posts/rm4scc-ben.png" target="_blank"><img src="/posts/rm4scc-ben.png" alt="Ben as a RM4SCC barcode" title="The &quot;Ben&quot; RM4SCC logo"/></a><figcaption class="image-title">The &quot;Ben&quot; RM4SCC logo</figcaption></figure></p>
<p>I love things like this, where to the casual observer it just looks like a stylised barcode, but those of us &quot;in the know&quot; can understand the hidden content.</p>
<p>To support this I added an option to the playground to force the barcode into a square shape. I&#x27;m not sure you can call these valid barcodes anymore, because they break the content and display constraints defined by Royal Mail, but that tradeoff is worth it to get a nice-looking result.</p>
<h2>SMIL Animations</h2>
<p>In addition to static SVG barcodes, I wanted to try adding some animation. The sequence of lines seem like a great candidate for a loading animation (or &quot;<a href="https://en.wikipedia.org/wiki/Throbber" target="_blank">throbber</a>&quot;) if I could get some movement in there somehow.</p>
<p>There&#x27;s a couple of options for animating SVGs:</p>
<ul>
<li>CSS animations for SVGs that will displayed on a webpage.</li>
<li>SMIL (Synchronized Multimedia Integration Language), which can be defined inside the SVG file as part of the markup.</li>
</ul>
<p>I opted for SMIL because it seemed useful to have the animation embedded directly in the output without requiring additional CSS blocks. SMIL is widely supported by browsers and may also <a href="https://css-tricks.com/how-i-made-a-generator-for-svg-loaders-with-sass-and-smil-options/#aa-smil-vs-css-sass" target="_blank">render a bit more smoothly</a> than CSS animations.</p>
<p>Here&#x27;s the markup from one animated rectangle in a complete animation:</p>
<pre><code class="hljs language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">rect</span> <span class="hljs-attr">x</span>=<span class="hljs-string">&quot;13.97&quot;</span> <span class="hljs-attr">y</span>=<span class="hljs-string">&quot;0&quot;</span> <span class="hljs-attr">width</span>=<span class="hljs-string">&quot;0.38&quot;</span> <span class="hljs-attr">height</span>=<span class="hljs-string">&quot;3.18&quot;</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">animate</span>
    <span class="hljs-attr">attributeName</span>=<span class="hljs-string">&quot;height&quot;</span>
    <span class="hljs-attr">from</span>=<span class="hljs-string">&quot;3.18&quot;</span>
    <span class="hljs-attr">to</span>=<span class="hljs-string">&quot;5.34&quot;</span>
    <span class="hljs-attr">values</span>=<span class="hljs-string">&quot;3.18; 5.34; 3.18; 3.18&quot;</span>
    <span class="hljs-attr">keyTimes</span>=<span class="hljs-string">&quot;0; 0.2; 0.4; 1&quot;</span>
    <span class="hljs-attr">dur</span>=<span class="hljs-string">&quot;1.25s&quot;</span>
    <span class="hljs-attr">begin</span>=<span class="hljs-string">&quot;0.4583s&quot;</span>
    <span class="hljs-attr">repeatCount</span>=<span class="hljs-string">&quot;indefinite&quot;</span>
  &gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">animate</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">rect</span>&gt;</span>
</code></pre>
<p>You can declare the <code>&lt;animate&gt;</code> element as a child of the node you want to animate, and the <code>attributeName</code> attribute specifies the attribute of the parent to be animated. The <code>values</code> and <code>keyTimes</code> attributes are declaring keyframes, which are timed values that the SVG will transition between. To make the animation pulse across the barcode I just offset the <code>begin</code> times based on the position.</p>
<video muted="" controls="" style="max-height:640px" src="/posts/rm4scc-animation.mov"></video>
<p>I was able to get a reasonable result with some very basic position/scale adjustments and time offsets. It turns out SMIL is a bit painful to work with, and for any complex animations (like <a href="https://css-tricks.com/guide-svg-animations-smil/#aa-controlling-animation-pace-with-custom-easing-calcmode-and-keysplines" target="_blank">easing movement in/out</a>) you can end up with some quite verbose syntax.</p>
<h2>Where next</h2>
<p>At this point I think I&#x27;ve seen most of what there is to explore RM4SCC barcodes specifically, but there&#x27;s still some things I&#x27;d like to look at in the future.</p>
<p>Any time an SVG is displayed at small resolutions, you run the risk that the pixels will be scaled in an uneven way.</p>
<p><figure class="image-wrapper"><a href="/posts/rm4scc-pixels.png" target="_blank"><img src="/posts/rm4scc-pixels.png" alt="Ugly pixel scaling" title="A small barcode - scaled up to show the ugly pixels"/></a><figcaption class="image-title">A small barcode - scaled up to show the ugly pixels</figcaption></figure></p>
<p>I think the solution to this would be some more manual tuning of the SVG definitions for lower resolutions, which would probably be worthwhile before displaying any of these barcodes as small loading icons. For any SVG being used as a web asset, it is also good to compress down and optimise the markup as much as possible.</p>
<p>Royal Mail also has a set of <a href="https://www.thedeliverygroup.co.uk/news/mailmark/" target="_blank">Mailmark</a> barcodes which I&#x27;d like to try building. From a quick glance at these, it looks like some of my RM4SCC rendering would be re-usable, but the 2D data matrix formats could be an interesting challenge.</p>
<p><figure class="image-wrapper"><a href="/posts/rm4scc-mailmark.png" target="_blank"><img src="/posts/rm4scc-mailmark.png" alt="Mailmark Barcodes" title="Royal Mail&#x27;s Mailmark barcodes"/></a><figcaption class="image-title">Royal Mail&#x27;s Mailmark barcodes</figcaption></figure></p></div><div class="linkSet-0-0-35"><a href="https://http://bencoveney.com/RM4SCC/" class="link-0-0-36"><i class="mdi mdi-web mdi-18px icon-0-0-37"></i> View website</a><a href="https://github.com/bencoveney/RM4SCC" class="link-0-0-36"><i class="mdi mdi-github-circle mdi-18px icon-0-0-37"></i> View on Github</a></div><ul class="technologies-0-0-11"><li class="technology-0-0-13 tagGreen-0-0-15"><i class="icon-0-0-16 mdi mdi-cube mdi-18px"></i><span class="tag-0-0-17">Project</span></li><li class="technology-0-0-13 tagRed-0-0-14"><i class="icon-0-0-16 mdi mdi-svg mdi-18px"></i><span class="tag-0-0-17">SVG</span></li><li class="technology-0-0-13 tagRed-0-0-14"><i class="icon-0-0-16 mdi mdi-language-javascript mdi-18px"></i><span class="tag-0-0-17">JavaScript</span></li><li class="technology-0-0-13 tagRed-0-0-14"><i class="icon-0-0-16 mdi mdi-language-typescript mdi-18px"></i><span class="tag-0-0-17">TypeScript</span></li><li class="technology-0-0-13 tagRed-0-0-14"><i class="icon-0-0-16 mdi mdi-react mdi-18px"></i><span class="tag-0-0-17">React</span></li></ul></div></div></body></html>